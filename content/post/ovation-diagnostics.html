---
title: Ovation Diagnostics
author: Matthew Paff
date: '2018-01-31'
slug: ovation-diagnostics
categories:
  - R
tags:
  - regression
  - plot
#blogdown::serve_site() to start local server
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotlyjs/plotly-latest.min.js"></script>


<div id="diagnosing-opioid-abuse-using-genotype-and-clinic-location." class="section level1">
<h1>Diagnosing opioid abuse using genotype and clinic location.</h1>
<p><em>Matthew Paff recently graduated from the University of Texas at Austin with a Ph.D.Â in Cell and Molecular Biology</em></p>
</div>
<div id="background" class="section level1">
<h1>Background</h1>
<p>Opioid abuse is a serious public health crisis that has reached epidemic proportions over the past few years (figure 1). In 2016, there were over 42,249 <a href="https://www.cdc.gov/drugoverdose/data/statedeaths.html">opioid-related deaths</a> in the United States, more than the number of Americans that die from breast cancer every year. It is currently the leading cause of injury death in the United States.</p>
<div class="figure"><span id="fig:heatMap"></span>
<img src="https://static01.nyt.com/images/2017/10/26/us/drug-deaths-promo-guide/drug-deaths-promo-guide-superJumbo.jpg?quality=100&auto=webp" alt="**Overdose deaths per 100,000 people (1999-2014)**. Haeyoun Park and Matthew Bloch - [The New York Times](https://nyti.ms/2jVUlKb)" width="100%" />
<p class="caption">
Figure 1: <strong>Overdose deaths per 100,000 people (1999-2014)</strong>. Haeyoun Park and Matthew Bloch - <a href="https://nyti.ms/2jVUlKb">The New York Times</a>
</p>
</div>
<p>Identifying patients who currently have, or are at risk of developing opioid habits early on may be a crucial step in slowing this epidemic</p>
<p>Historically, physicians have relied primarily on subjective clinical risk factors such as family history, medical history, and various social and environmental factors, but there is increasing interest in utilizing <a href="https://www.sciencedaily.com/releases/2017/12/171213130411.htm">genetic screening</a> to identify at-risk patients.</p>
</div>
<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>Ovation provided me with a dataset with information from nearly 4000 patients. Data included information on the clinic where the patients were treated, their diagnosis in the form of an ICD-10 code (International Statistical Classification of Diseases and Related Health Problems), and the results from genetic testing, identified as SNPs (single nucleotide polymorphisms), or genetic mutations.</p>
<p>This data had information from over 1850 different diagnoses and 485 gene loci. Now this dataset was wonderfully complex and required extensive manipulation before analysis could be performed. The first step however, was rather straightforward however. For the goals of this analysis, I was only interested (at least initially) in the ICD-10 codes related to opioid addiction and abuse. As a result, I was able to reduce the ~1850 diagnosis features (of which only 8 were related to opioid abuse) to a single binary column in which each patient was diagnosed as positive for opioid abuse or not (figure 1A).</p>
<div class="figure"><span id="fig:opProp"></span>
<div id="a7661ac2fe87" style="width:864px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="a7661ac2fe87">{"x":{"data":[{"orientation":"v","width":0.9,"base":0,"x":[1],"y":[3148],"text":"count: 3148","type":"bar","marker":{"autocolorscale":false,"color":"rgba(86,180,233,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"0","legendgroup":"0","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":0,"x":[2],"y":[175],"text":"count:  175","type":"bar","marker":{"autocolorscale":false,"color":"rgba(213,94,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7],"y":[0.1,0.0909090909090909,0.195652173913043,0.0476190476190476,0.866666666666667,0.423357664233577,0.00681818181818182],"text":["ratio: 0.100000000","ratio: 0.090909091","ratio: 0.195652174","ratio: 0.047619048","ratio: 0.866666667","ratio: 0.423357664","ratio: 0.006818182"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(213,94,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.4],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,2.6],"ticktext":["Negative","Positive"],"tickvals":[1,2],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":21.2536322125363},"tickangle":-60,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Opioid abuse diagnosis","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":29.2237442922374},"hoverformat":".2f"},"xaxis2":{"domain":[0.6,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,7.6],"ticktext":["Clinic 1","Clinic 2","Clinic 3","Clinic 4","Clinic 5","Clinic 6","Clinic 7"],"tickvals":[1,2,3,4,5,6,7],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":21.2536322125363},"tickangle":-60,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"Clinic","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":29.2237442922374},"hoverformat":".2f"},"yaxis2":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,1],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":21.2536322125363},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x2","title":"Percent of patients with <br />opioid abuse diagnosis","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":29.2237442922374},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,3500],"ticktext":["0","1000","2000","3000"],"tickvals":[0,1000,2000,3000],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":21.2536322125363},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Number of patients","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":29.2237442922374},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.4,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.6,"x1":1,"y0":0,"y1":1}],"margin":{"t":32.7372353673723,"r":9.29846409298464,"b":150,"l":110},"font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":15.9375674553757}},"barmode":"stack","hovermode":"closest"},"attrs":{"a7667b7acda0":{"x":{},"fill":{},"type":"ggplotly"},"a7667ed1729":{"x":{},"y":{},"type":"ggplotly"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 2: <strong>A.</strong> Number of negative and positive opioid abuse diagnoses. <strong>B.</strong> Proportion of patients with a positive opioid abuse diagnosis for a given clinic compared to the total number of patients. Only clinics with at least 1 opioid patient are included (114 clinics have 0 patients diagnosed with opioid abuse).
</p>
</div>
</div>
