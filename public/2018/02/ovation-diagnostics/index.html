

  
    
  


  





  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.35 with theme Tranquilpeak 0.4.3-BETA">
    <title>Ovation.io</title>
    <meta name="author" content="Matthew Paff">
    <meta name="keywords" content="">

    <link rel="icon" href="/favicon.png">
    

    
    <meta name="description" content="Identifying patients at risk for opioid dependence Matthew Paff, an Insight Health Data Science fellow (Spring, 2018), recently graduated from the University of Texas at Austin with a Ph.D. in Cell and Molecular Biology. There he modeled population dynamics of transmissible anti-viral defense using bacteriophage (viruses that infect bacteria) and developed novel approaches for genetically engineering attenuated vaccines.
This spring I participated in the Insight Health Data Science Fellowship, working as a consultant for Ovation; a provider of cloud-based LIMS and commercial platform for specialzed diagnostic labs.">
    <meta property="og:description" content="Identifying patients at risk for opioid dependence Matthew Paff, an Insight Health Data Science fellow (Spring, 2018), recently graduated from the University of Texas at Austin with a Ph.D. in Cell and Molecular Biology. There he modeled population dynamics of transmissible anti-viral defense using bacteriophage (viruses that infect bacteria) and developed novel approaches for genetically engineering attenuated vaccines.
This spring I participated in the Insight Health Data Science Fellowship, working as a consultant for Ovation; a provider of cloud-based LIMS and commercial platform for specialzed diagnostic labs.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Ovation.io">
    <meta property="og:url" content="/2018/02/ovation-diagnostics/">
    <meta property="og:site_name" content="Matthew Paff">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Matthew Paff">
    <meta name="twitter:description" content="Identifying patients at risk for opioid dependence Matthew Paff, an Insight Health Data Science fellow (Spring, 2018), recently graduated from the University of Texas at Austin with a Ph.D. in Cell and Molecular Biology. There he modeled population dynamics of transmissible anti-viral defense using bacteriophage (viruses that infect bacteria) and developed novel approaches for genetically engineering attenuated vaccines.
This spring I participated in the Insight Health Data Science Fellowship, working as a consultant for Ovation; a provider of cloud-based LIMS and commercial platform for specialzed diagnostic labs.">
    
    

    
    

    
      <meta property="og:image" content="/img/finn.jpg">
    

    
    
      <meta property="og:image" content="/imgs/UT.jpg">
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Matthew Paff</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="/img/finn.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Matthew Paff</h4>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/mlpaff">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/matthew-paff/">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin-square"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-left
              "
       style="background-image:url('../imgs/UT.jpg')"
       data-behavior="4">
    
      <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Ovation.io
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2018-02-02T00:00:00Z">
        
  February 2, 2018

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/health-data-science">Health Data Science</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotlyjs/plotly-latest.min.js"></script>


<div id="identifying-patients-at-risk-for-opioid-dependence" class="section level1">
<h1>Identifying patients at risk for opioid dependence</h1>
<p><em>Matthew Paff, an Insight Health Data Science fellow (Spring, 2018), recently graduated from the University of Texas at Austin with a Ph.D. in Cell and Molecular Biology. There he modeled population dynamics of transmissible anti-viral defense using bacteriophage (viruses that infect bacteria) and developed novel approaches for genetically engineering attenuated vaccines.</em></p>
<p>This spring I participated in the Insight Health Data Science Fellowship, working as a consultant for <a href="https://www.ovation.io/">Ovation</a>; a provider of cloud-based LIMS and commercial platform for specialzed diagnostic labs. More recently, Ovation has been interested in additionally providing data driven analytics and solutions to enhance patient care for their clients. Over the past few weeks, I have been working with Ovation to leverage their clinical data to address a particularly important public health issue: the opioid epidemic..</p>
<div id="background" class="section level2">
<h2>Background</h2>
<p>Opioid abuse is a serious public health crisis that has reached epidemic proportions over the past few years (figure 1). In 2016, there were over 42,249 <a href="https://www.cdc.gov/drugoverdose/data/statedeaths.html">opioid-related deaths</a> in the United States. This is more than the number of Americans that die from breast cancer every year. Unfortunately, overprescription of pain medication is a significant contributor to this problem. In 2015, there were over 300 million opioid prescriptions written in the US, with <a href="https://www.cnbc.com/2016/04/27/americans-consume-almost-all-of-the-global-opioid-supply.html">Americans consuming over 80%</a> of the global opioid supply.</p>
<div class="figure"><span id="fig:heatMap"></span>
<img src="https://static01.nyt.com/images/2017/10/26/us/drug-deaths-promo-guide/drug-deaths-promo-guide-superJumbo.jpg?quality=100&auto=webp" alt="**Overdose deaths per 100,000 people (1999-2014)**. Haeyoun Park and Matthew Bloch - [The New York Times](https://nyti.ms/2jVUlKb)" width="100%" />
<p class="caption">
Figure 1: <strong>Overdose deaths per 100,000 people (1999-2014)</strong>. Haeyoun Park and Matthew Bloch - <a href="https://nyti.ms/2jVUlKb">The New York Times</a>
</p>
</div>
<p>Early identification of patients with opioid addiction or those who may be at increased risk of developing opioid abuse habits could be a crucial step in slowing this epidemic, at least when it comes to prescription pain medication. It is therefore important that we continue to develop novel approaches to identifying those that could be more susceptible to opioid addiction. Historically, physicians have relied primarily on subjective clinical risk factors such as family history, medical history, and various social and environmental factors, but there is increasing interest in utilizing <a href="https://www.sciencedaily.com/releases/2017/12/171213130411.htm">genetic screening</a> to identify at-risk patients.</p>
<p>Ovation was interested in asking whether they could leverage aggregated clinical data to address this opioid dependence problem. More specifically, they wanted to measure what contribution, if any, geographic population structure played in the identification of these patients. In this case, I used patients’ clinics as a proxy for patient geography Here I used genetic sequencing data and information on the patients’ clinics to train a machine-learning model in Python to identify patients diagnosed with opioid dependence. I was primarily interested in quantifying the role that the individual clinics play in making these predictions.</p>
</div>
<div id="the-data" class="section level2">
<h2>The Data</h2>
<p>I was provided with a dataset with information from over 3300 patients, a small random subset from their database. Within this data, I worked with three primary classes of information:</p>
<ol style="list-style-type: decimal">
<li>Patient diagnosis</li>
<li>Genotyping results</li>
<li>Name of the clinic where each patient was treated</li>
</ol>
<p>Included within these categories was information from over 1850 different diagnoses in the form of ICD-10 codes (International Statistical Classification of Diseases and Related Health Problems), 485 genes, and 121 clinics. Now this dataset was wonderfully complex and required quite a bit of initial manipulation and transformation. The first step however was rather straightforward. Since I was only interested in the opioid dependence diagnosis (at least initially), I selected only the ICD-10 codes related to opioid abuse, of which there were only 7, and combined them into a single binary column (positive or negative diagnosis), filtering out the remaining unassociated diseases.</p>
<p>In diving into the genetic data, I found that the distribution in sequencing converage was highly skewed (figure 1). Fewer than 40 genes were sequenced for more than 2000 patients. Coverage quickly drops off after that, with nearly 150 genes appearing to have been sequenced in fewer than 5 patients.</p>
<div class="figure"><span id="fig:genes"></span>
<div id="ffe4792f10b7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ffe4792f10b7">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.899999999999991,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977,0.899999999999977],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422],"y":[2108,2107,2105,2105,2105,2105,2104,2104,2103,2103,2103,2102,2102,2102,2102,2100,2099,2099,2099,2098,2098,2098,2097,2096,2096,2096,2096,2096,2095,2095,2092,2077,1889,1886,1885,1885,1880,1878,1876,1862,1802,1798,1797,1797,1795,1794,1793,1791,1771,1584,1582,1579,1570,1553,1546,1543,1543,1540,1329,1321,1299,1117,1086,1019,1019,563,563,563,561,561,560,559,550,522,469,428,427,361,334,334,332,329,328,308,308,303,301,245,242,223,223,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,222,221,221,221,221,221,221,221,221,221,221,221,221,220,220,220,219,219,218,218,217,216,216,216,216,215,215,214,212,206,206,157,150,150,150,150,150,150,149,149,149,149,149,149,148,147,101,72,72,72,72,72,72,72,71,71,71,71,71,70,70,49,40,31,31,31,31,29,29,29,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,25,25,24,21,16,12,12,12,12,11,8,8,8,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"text":["gene:   1<br />n: 2108","gene:   2<br />n: 2107","gene:   3<br />n: 2105","gene:   4<br />n: 2105","gene:   5<br />n: 2105","gene:   6<br />n: 2105","gene:   7<br />n: 2104","gene:   8<br />n: 2104","gene:   9<br />n: 2103","gene:  10<br />n: 2103","gene:  11<br />n: 2103","gene:  12<br />n: 2102","gene:  13<br />n: 2102","gene:  14<br />n: 2102","gene:  15<br />n: 2102","gene:  16<br />n: 2100","gene:  17<br />n: 2099","gene:  18<br />n: 2099","gene:  19<br />n: 2099","gene:  20<br />n: 2098","gene:  21<br />n: 2098","gene:  22<br />n: 2098","gene:  23<br />n: 2097","gene:  24<br />n: 2096","gene:  25<br />n: 2096","gene:  26<br />n: 2096","gene:  27<br />n: 2096","gene:  28<br />n: 2096","gene:  29<br />n: 2095","gene:  30<br />n: 2095","gene:  31<br />n: 2092","gene:  32<br />n: 2077","gene:  33<br />n: 1889","gene:  34<br />n: 1886","gene:  35<br />n: 1885","gene:  36<br />n: 1885","gene:  37<br />n: 1880","gene:  38<br />n: 1878","gene:  39<br />n: 1876","gene:  40<br />n: 1862","gene:  41<br />n: 1802","gene:  42<br />n: 1798","gene:  43<br />n: 1797","gene:  44<br />n: 1797","gene:  45<br />n: 1795","gene:  46<br />n: 1794","gene:  47<br />n: 1793","gene:  48<br />n: 1791","gene:  49<br />n: 1771","gene:  50<br />n: 1584","gene:  51<br />n: 1582","gene:  52<br />n: 1579","gene:  53<br />n: 1570","gene:  54<br />n: 1553","gene:  55<br />n: 1546","gene:  56<br />n: 1543","gene:  57<br />n: 1543","gene:  58<br />n: 1540","gene:  59<br />n: 1329","gene:  60<br />n: 1321","gene:  61<br />n: 1299","gene:  62<br />n: 1117","gene:  63<br />n: 1086","gene:  64<br />n: 1019","gene:  65<br />n: 1019","gene:  66<br />n:  563","gene:  67<br />n:  563","gene:  68<br />n:  563","gene:  69<br />n:  561","gene:  70<br />n:  561","gene:  71<br />n:  560","gene:  72<br />n:  559","gene:  73<br />n:  550","gene:  74<br />n:  522","gene:  75<br />n:  469","gene:  76<br />n:  428","gene:  77<br />n:  427","gene:  78<br />n:  361","gene:  79<br />n:  334","gene:  80<br />n:  334","gene:  81<br />n:  332","gene:  82<br />n:  329","gene:  83<br />n:  328","gene:  84<br />n:  308","gene:  85<br />n:  308","gene:  86<br />n:  303","gene:  87<br />n:  301","gene:  88<br />n:  245","gene:  89<br />n:  242","gene:  90<br />n:  223","gene:  91<br />n:  223","gene:  92<br />n:  222","gene:  93<br />n:  222","gene:  94<br />n:  222","gene:  95<br />n:  222","gene:  96<br />n:  222","gene:  97<br />n:  222","gene:  98<br />n:  222","gene:  99<br />n:  222","gene: 100<br />n:  222","gene: 101<br />n:  222","gene: 102<br />n:  222","gene: 103<br />n:  222","gene: 104<br />n:  222","gene: 105<br />n:  222","gene: 106<br />n:  222","gene: 107<br />n:  222","gene: 108<br />n:  222","gene: 109<br />n:  222","gene: 110<br />n:  222","gene: 111<br />n:  222","gene: 112<br />n:  222","gene: 113<br />n:  222","gene: 114<br />n:  222","gene: 115<br />n:  222","gene: 116<br />n:  222","gene: 117<br />n:  222","gene: 118<br />n:  221","gene: 119<br />n:  221","gene: 120<br />n:  221","gene: 121<br />n:  221","gene: 122<br />n:  221","gene: 123<br />n:  221","gene: 124<br />n:  221","gene: 125<br />n:  221","gene: 126<br />n:  221","gene: 127<br />n:  221","gene: 128<br />n:  221","gene: 129<br />n:  221","gene: 130<br />n:  220","gene: 131<br />n:  220","gene: 132<br />n:  220","gene: 133<br />n:  219","gene: 134<br />n:  219","gene: 135<br />n:  218","gene: 136<br />n:  218","gene: 137<br />n:  217","gene: 138<br />n:  216","gene: 139<br />n:  216","gene: 140<br />n:  216","gene: 141<br />n:  216","gene: 142<br />n:  215","gene: 143<br />n:  215","gene: 144<br />n:  214","gene: 145<br />n:  212","gene: 146<br />n:  206","gene: 147<br />n:  206","gene: 148<br />n:  157","gene: 149<br />n:  150","gene: 150<br />n:  150","gene: 151<br />n:  150","gene: 152<br />n:  150","gene: 153<br />n:  150","gene: 154<br />n:  150","gene: 155<br />n:  149","gene: 156<br />n:  149","gene: 157<br />n:  149","gene: 158<br />n:  149","gene: 159<br />n:  149","gene: 160<br />n:  149","gene: 161<br />n:  148","gene: 162<br />n:  147","gene: 163<br />n:  101","gene: 164<br />n:   72","gene: 165<br />n:   72","gene: 166<br />n:   72","gene: 167<br />n:   72","gene: 168<br />n:   72","gene: 169<br />n:   72","gene: 170<br />n:   72","gene: 171<br />n:   71","gene: 172<br />n:   71","gene: 173<br />n:   71","gene: 174<br />n:   71","gene: 175<br />n:   71","gene: 176<br />n:   70","gene: 177<br />n:   70","gene: 178<br />n:   49","gene: 179<br />n:   40","gene: 180<br />n:   31","gene: 181<br />n:   31","gene: 182<br />n:   31","gene: 183<br />n:   31","gene: 184<br />n:   29","gene: 185<br />n:   29","gene: 186<br />n:   29","gene: 187<br />n:   26","gene: 188<br />n:   26","gene: 189<br />n:   26","gene: 190<br />n:   26","gene: 191<br />n:   26","gene: 192<br />n:   26","gene: 193<br />n:   26","gene: 194<br />n:   26","gene: 195<br />n:   26","gene: 196<br />n:   26","gene: 197<br />n:   26","gene: 198<br />n:   26","gene: 199<br />n:   26","gene: 200<br />n:   26","gene: 201<br />n:   26","gene: 202<br />n:   26","gene: 203<br />n:   26","gene: 204<br />n:   26","gene: 205<br />n:   26","gene: 206<br />n:   26","gene: 207<br />n:   26","gene: 208<br />n:   26","gene: 209<br />n:   26","gene: 210<br />n:   26","gene: 211<br />n:   26","gene: 212<br />n:   26","gene: 213<br />n:   26","gene: 214<br />n:   26","gene: 215<br />n:   26","gene: 216<br />n:   26","gene: 217<br />n:   26","gene: 218<br />n:   26","gene: 219<br />n:   26","gene: 220<br />n:   26","gene: 221<br />n:   26","gene: 222<br />n:   26","gene: 223<br />n:   26","gene: 224<br />n:   26","gene: 225<br />n:   26","gene: 226<br />n:   26","gene: 227<br />n:   25","gene: 228<br />n:   25","gene: 229<br />n:   24","gene: 230<br />n:   21","gene: 231<br />n:   16","gene: 232<br />n:   12","gene: 233<br />n:   12","gene: 234<br />n:   12","gene: 235<br />n:   12","gene: 236<br />n:   11","gene: 237<br />n:    8","gene: 238<br />n:    8","gene: 239<br />n:    8","gene: 240<br />n:    6","gene: 241<br />n:    6","gene: 242<br />n:    6","gene: 243<br />n:    6","gene: 244<br />n:    6","gene: 245<br />n:    6","gene: 246<br />n:    5","gene: 247<br />n:    5","gene: 248<br />n:    5","gene: 249<br />n:    5","gene: 250<br />n:    5","gene: 251<br />n:    5","gene: 252<br />n:    5","gene: 253<br />n:    5","gene: 254<br />n:    5","gene: 255<br />n:    4","gene: 256<br />n:    4","gene: 257<br />n:    4","gene: 258<br />n:    4","gene: 259<br />n:    3","gene: 260<br />n:    3","gene: 261<br />n:    3","gene: 262<br />n:    3","gene: 263<br />n:    3","gene: 264<br />n:    3","gene: 265<br />n:    3","gene: 266<br />n:    3","gene: 267<br />n:    3","gene: 268<br />n:    3","gene: 269<br />n:    3","gene: 270<br />n:    3","gene: 271<br />n:    3","gene: 272<br />n:    3","gene: 273<br />n:    3","gene: 274<br />n:    3","gene: 275<br />n:    3","gene: 276<br />n:    3","gene: 277<br />n:    3","gene: 278<br />n:    3","gene: 279<br />n:    3","gene: 280<br />n:    3","gene: 281<br />n:    3","gene: 282<br />n:    3","gene: 283<br />n:    3","gene: 284<br />n:    3","gene: 285<br />n:    3","gene: 286<br />n:    3","gene: 287<br />n:    3","gene: 288<br />n:    3","gene: 289<br />n:    2","gene: 290<br />n:    2","gene: 291<br />n:    2","gene: 292<br />n:    2","gene: 293<br />n:    2","gene: 294<br />n:    2","gene: 295<br />n:    2","gene: 296<br />n:    1","gene: 297<br />n:    1","gene: 298<br />n:    1","gene: 299<br />n:    1","gene: 300<br />n:    1","gene: 301<br />n:    1","gene: 302<br />n:    1","gene: 303<br />n:    1","gene: 304<br />n:    1","gene: 305<br />n:    1","gene: 306<br />n:    1","gene: 307<br />n:    1","gene: 308<br />n:    1","gene: 309<br />n:    1","gene: 310<br />n:    1","gene: 311<br />n:    1","gene: 312<br />n:    1","gene: 313<br />n:    1","gene: 314<br />n:    1","gene: 315<br />n:    1","gene: 316<br />n:    1","gene: 317<br />n:    1","gene: 318<br />n:    1","gene: 319<br />n:    1","gene: 320<br />n:    1","gene: 321<br />n:    1","gene: 322<br />n:    1","gene: 323<br />n:    1","gene: 324<br />n:    1","gene: 325<br />n:    1","gene: 326<br />n:    1","gene: 327<br />n:    1","gene: 328<br />n:    1","gene: 329<br />n:    1","gene: 330<br />n:    1","gene: 331<br />n:    1","gene: 332<br />n:    1","gene: 333<br />n:    1","gene: 334<br />n:    1","gene: 335<br />n:    1","gene: 336<br />n:    1","gene: 337<br />n:    1","gene: 338<br />n:    1","gene: 339<br />n:    1","gene: 340<br />n:    1","gene: 341<br />n:    1","gene: 342<br />n:    1","gene: 343<br />n:    1","gene: 344<br />n:    1","gene: 345<br />n:    1","gene: 346<br />n:    1","gene: 347<br />n:    1","gene: 348<br />n:    1","gene: 349<br />n:    1","gene: 350<br />n:    1","gene: 351<br />n:    1","gene: 352<br />n:    1","gene: 353<br />n:    1","gene: 354<br />n:    1","gene: 355<br />n:    1","gene: 356<br />n:    1","gene: 357<br />n:    1","gene: 358<br />n:    1","gene: 359<br />n:    1","gene: 360<br />n:    1","gene: 361<br />n:    1","gene: 362<br />n:    1","gene: 363<br />n:    1","gene: 364<br />n:    1","gene: 365<br />n:    1","gene: 366<br />n:    1","gene: 367<br />n:    1","gene: 368<br />n:    1","gene: 369<br />n:    1","gene: 370<br />n:    1","gene: 371<br />n:    1","gene: 372<br />n:    1","gene: 373<br />n:    1","gene: 374<br />n:    1","gene: 375<br />n:    1","gene: 376<br />n:    1","gene: 377<br />n:    1","gene: 378<br />n:    1","gene: 379<br />n:    1","gene: 380<br />n:    1","gene: 381<br />n:    1","gene: 382<br />n:    1","gene: 383<br />n:    1","gene: 384<br />n:    1","gene: 385<br />n:    1","gene: 386<br />n:    1","gene: 387<br />n:    1","gene: 388<br />n:    1","gene: 389<br />n:    1","gene: 390<br />n:    1","gene: 391<br />n:    1","gene: 392<br />n:    1","gene: 393<br />n:    1","gene: 394<br />n:    1","gene: 395<br />n:    1","gene: 396<br />n:    1","gene: 397<br />n:    1","gene: 398<br />n:    1","gene: 399<br />n:    1","gene: 400<br />n:    1","gene: 401<br />n:    1","gene: 402<br />n:    1","gene: 403<br />n:    1","gene: 404<br />n:    1","gene: 405<br />n:    1","gene: 406<br />n:    1","gene: 407<br />n:    1","gene: 408<br />n:    1","gene: 409<br />n:    1","gene: 410<br />n:    1","gene: 411<br />n:    1","gene: 412<br />n:    1","gene: 413<br />n:    1","gene: 414<br />n:    1","gene: 415<br />n:    1","gene: 416<br />n:    1","gene: 417<br />n:    1","gene: 418<br />n:    1","gene: 419<br />n:    1","gene: 420<br />n:    1","gene: 421<br />n:    1","gene: 422<br />n:    1"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(49,163,84,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":29.0178497301785,"r":9.29846409298464,"b":75,"l":110},"font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.55,422.45],"ticktext":["100","200","300","400"],"tickvals":[100,200,300,400],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Gene","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,2108],"ticktext":["0","500","1000","1500","2000"],"tickvals":[0,500,1000,1500,2000],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Number of patients","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":15.9375674553757}},"barmode":"stack","bargap":0,"hovermode":"closest"},"source":"A","attrs":{"ffe4443ed571":{"x":{},"y":{},"type":"ggplotly"}},"cur_data":"ffe4443ed571","visdat":{"ffe4443ed571":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 2: Distribution of gene sequencing coverage. Number of patients with sequencing information for a given gene
</p>
</div>
<p>In addition to uneven coverage, the genetic data was quite complex. Sequencing results for each of the 485 genes were in the form of SNP (single nucleotide polymorphisms) calls, or mutations. These SNPs were identified in several forms; the bases present in the assay (e.g. A/A/, A/G, T, -/C,…), whether a particular SNP was present, or as copy number variants (CNVs - e.g. 0, 1, 2,…). For a given gene, the patients could have one of anywhere between 0 and 8 unique SNP calls (those for which no test was performed were listed as ‘none’). To transform this data into a form that could be used for model training, I used one-hot encoding, where each unique SNP call within a given gene becomes its own feature, now encoded as a binary value indicating whether the mutation is present or absent. One-hot encoding the genetic data resulted in an expansion in the dimentionality of the gene feature set (from 485 to more than 1300). In order to reduce some of this dimentionality, I chose to focus only on the features that contained actual genetic mutation information, removing the “none” gene features that only indicated lack of a test being performed.</p>
<p>I next wanted to look at the distribution of patients with a positive opioid abuse diagnosis across the 121 clinics within the dataset. Out of the 121 clinics included, only 7 had at least 1 patient with a positive opioid abuse diagnosis. The ratio of positive to total patients within these 7 clincs varied significantly, from less than 1% to 87% (figure 1). In addition, the total number of positive opioid patients was only 175 compared to 3148 patients identified as negative for opioid abuse. This result indicated that the dataset was highly imbalanced; something that I would need to account for before implementing any sort of machine learning algorithm.</p>
<div class="figure" style="text-align: center"><span id="fig:opProp"></span>
<div id="ffe4b11fd9d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ffe4b11fd9d">{"x":{"data":[{"orientation":"v","width":0.9,"base":0,"x":[1],"y":[3148],"text":"count: 3148","type":"bar","marker":{"autocolorscale":false,"color":"rgba(86,180,233,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"0","legendgroup":"0","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":0,"x":[2],"y":[175],"text":"count:  175","type":"bar","marker":{"autocolorscale":false,"color":"rgba(213,94,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9],"base":[0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7],"y":[0.1,0.0909,0.1957,0.0476,0.8667,0.4234,0.0068],"text":["Ratio: 0.1000","Ratio: 0.0909","Ratio: 0.1957","Ratio: 0.0476","Ratio: 0.8667","Ratio: 0.4234","Ratio: 0.0068"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(213,94,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.4],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,2.6],"ticktext":["Negative","Positive"],"tickvals":[1,2],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-60,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Opioid abuse diagnosis","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"xaxis2":{"domain":[0.6,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,7.6],"ticktext":["Clinic 1","Clinic 2","Clinic 3","Clinic 4","Clinic 5","Clinic 6","Clinic 7"],"tickvals":[1,2,3,4,5,6,7],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-60,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"Clinic","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"yaxis2":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,1],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x2","title":"% Positive opioid patients","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,3500],"ticktext":["0","1000","2000","3000"],"tickvals":[0,1000,2000,3000],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Number of patients","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.4,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.6,"x1":1,"y0":0,"y1":1}],"margin":{"t":29.0178497301785,"r":9.29846409298464,"b":150,"l":110},"font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":15.9375674553757}},"barmode":"stack","hovermode":"closest"},"attrs":{"ffe443d3adf6":{"x":{},"fill":{},"type":"ggplotly"},"ffe4569d439":{"x":{},"y":{},"type":"ggplotly"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 3: Left - total number of negative (blue) and positive (orange) opioid abuse diagnoses. Right - Proportion of patients with a positive opioid abuse diagnosis for a given clinic compared to the total number of patients treated at that clinic. Only clinics with at least 1 opioid patient are included (114 remaining clinics have 0 patients with a positive diagnosis).
</p>
</div>
</div>
<div id="model-implementation-and-results" class="section level2">
<h2>Model Implementation and Results</h2>
<p>The primary goal of this project was to determine the role of the clinic in identifying those patients with increased risk of opioid dependence. My strategy for accomplishing this was to train two logistic regression models using scikit-learn in Python to predict the patients’ opioid dependence diagnosis. The first model incorporated only the one-hot encoded genetic features (of which there were 876), while the second model incorporated both genetic information as well as the clinic where each patient received treatment. In training two separate models with and without the clinic data, I could compare their performances to determine the predictive contribution of the clinic information.</p>
<p>To train the models, I used 75% of the data, reserving the remaining 25% off for final validation of the models. The first thing I needed to do before training was balance the opioid abuse diagnosis classes. Training a logistic regression model without first balancing the diagnosis classes, would just result in a model that could just predict negative the entire time and still be highly accurate. I tested two methods of balancing, oversampling the under-represented class with replacement or changing the “class_weight” parameter to “balanced,” which penalizes mis-classifying the minority class by an amount proportional to the level of imbalance. Both methods were comparable, but I used the “class_weight” balance to report my results here.</p>
<p>Due to the high dimentionality as well as sparsity of some of my features, I used L1 regularization when performing the logistic regression. The benefit of L1 regularization is to reduce the coefficients of the unimportant features to 0, eliminating them as features in the model. Both models were implemented using the same training set, with the only difference being that I filtered out the clinic features before training the model to predict opioid abuse using the genotype data alone.</p>
<p>The validation (test) set was used to calulate the receiver operator characteristic (ROC) and area under the curve (AUC) for both models (figure 4). The AUC improved signicantly, from 0.81 to 0.942, when including the clinic where the patients were treated in the model.</p>
<div class="figure"><span id="fig:ROC"></span>
<div id="ffe434d151ba" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ffe434d151ba">{"x":{"data":[{"x":[0,0.0013,0.0013,0.0051,0.0051,0.0076,0.0076,0.0102,0.0165,0.0165,0.0191,0.0191,0.0203,0.0203,0.0254,0.0254,0.0267,0.0267,0.028,0.028,0.0432,0.0432,0.0457,0.0457,0.0508,0.0508,0.0712,0.0712,0.094,0.094,0.1029,0.1029,0.1461,0.1461,0.1487,0.1487,0.1665,0.1665,0.1893,0.1893,0.1944,0.1944,0.1982,0.1982,0.2122,0.2122,0.2224,0.2224,0.2262,0.2262,0.2618,0.2618,0.2795,0.2795,0.2846,0.2846,0.2935,0.2935,0.2961,0.2961,0.2986,0.2986,0.2999,0.2999,0.3151,0.3151,0.3266,0.3266,0.3329,0.3329,0.4435,0.8297,0.9022,0.9072,0.9263,0.9288,0.953,0.9555,1],"y":[0,0,0.0455,0.0455,0.0682,0.0682,0.0909,0.0909,0.0909,0.1136,0.1136,0.1591,0.1591,0.1818,0.1818,0.2045,0.2045,0.2273,0.2273,0.25,0.25,0.2727,0.2727,0.2955,0.2955,0.3409,0.3409,0.3636,0.3636,0.3864,0.3864,0.4091,0.4091,0.4545,0.4545,0.4773,0.4773,0.5455,0.5455,0.5682,0.5682,0.5909,0.5909,0.6136,0.6136,0.6364,0.6364,0.6591,0.6591,0.6818,0.6818,0.7045,0.7045,0.7273,0.7273,0.75,0.75,0.7727,0.7727,0.7955,0.7955,0.8182,0.8182,0.8409,0.8409,0.8636,0.8636,0.8864,0.8864,0.9091,0.9091,1,1,1,1,1,1,1,1],"text":["FPR: 0.0000<br />TPR: 0.0000","FPR: 0.0013<br />TPR: 0.0000","FPR: 0.0013<br />TPR: 0.0455","FPR: 0.0051<br />TPR: 0.0455","FPR: 0.0051<br />TPR: 0.0682","FPR: 0.0076<br />TPR: 0.0682","FPR: 0.0076<br />TPR: 0.0909","FPR: 0.0102<br />TPR: 0.0909","FPR: 0.0165<br />TPR: 0.0909","FPR: 0.0165<br />TPR: 0.1136","FPR: 0.0191<br />TPR: 0.1136","FPR: 0.0191<br />TPR: 0.1591","FPR: 0.0203<br />TPR: 0.1591","FPR: 0.0203<br />TPR: 0.1818","FPR: 0.0254<br />TPR: 0.1818","FPR: 0.0254<br />TPR: 0.2045","FPR: 0.0267<br />TPR: 0.2045","FPR: 0.0267<br />TPR: 0.2273","FPR: 0.0280<br />TPR: 0.2273","FPR: 0.0280<br />TPR: 0.2500","FPR: 0.0432<br />TPR: 0.2500","FPR: 0.0432<br />TPR: 0.2727","FPR: 0.0457<br />TPR: 0.2727","FPR: 0.0457<br />TPR: 0.2955","FPR: 0.0508<br />TPR: 0.2955","FPR: 0.0508<br />TPR: 0.3409","FPR: 0.0712<br />TPR: 0.3409","FPR: 0.0712<br />TPR: 0.3636","FPR: 0.0940<br />TPR: 0.3636","FPR: 0.0940<br />TPR: 0.3864","FPR: 0.1029<br />TPR: 0.3864","FPR: 0.1029<br />TPR: 0.4091","FPR: 0.1461<br />TPR: 0.4091","FPR: 0.1461<br />TPR: 0.4545","FPR: 0.1487<br />TPR: 0.4545","FPR: 0.1487<br />TPR: 0.4773","FPR: 0.1665<br />TPR: 0.4773","FPR: 0.1665<br />TPR: 0.5455","FPR: 0.1893<br />TPR: 0.5455","FPR: 0.1893<br />TPR: 0.5682","FPR: 0.1944<br />TPR: 0.5682","FPR: 0.1944<br />TPR: 0.5909","FPR: 0.1982<br />TPR: 0.5909","FPR: 0.1982<br />TPR: 0.6136","FPR: 0.2122<br />TPR: 0.6136","FPR: 0.2122<br />TPR: 0.6364","FPR: 0.2224<br />TPR: 0.6364","FPR: 0.2224<br />TPR: 0.6591","FPR: 0.2262<br />TPR: 0.6591","FPR: 0.2262<br />TPR: 0.6818","FPR: 0.2618<br />TPR: 0.6818","FPR: 0.2618<br />TPR: 0.7045","FPR: 0.2795<br />TPR: 0.7045","FPR: 0.2795<br />TPR: 0.7273","FPR: 0.2846<br />TPR: 0.7273","FPR: 0.2846<br />TPR: 0.7500","FPR: 0.2935<br />TPR: 0.7500","FPR: 0.2935<br />TPR: 0.7727","FPR: 0.2961<br />TPR: 0.7727","FPR: 0.2961<br />TPR: 0.7955","FPR: 0.2986<br />TPR: 0.7955","FPR: 0.2986<br />TPR: 0.8182","FPR: 0.2999<br />TPR: 0.8182","FPR: 0.2999<br />TPR: 0.8409","FPR: 0.3151<br />TPR: 0.8409","FPR: 0.3151<br />TPR: 0.8636","FPR: 0.3266<br />TPR: 0.8636","FPR: 0.3266<br />TPR: 0.8864","FPR: 0.3329<br />TPR: 0.8864","FPR: 0.3329<br />TPR: 0.9091","FPR: 0.4435<br />TPR: 0.9091","FPR: 0.8297<br />TPR: 1.0000","FPR: 0.9022<br />TPR: 1.0000","FPR: 0.9072<br />TPR: 1.0000","FPR: 0.9263<br />TPR: 1.0000","FPR: 0.9288<br />TPR: 1.0000","FPR: 0.9530<br />TPR: 1.0000","FPR: 0.9555<br />TPR: 1.0000","FPR: 1.0000<br />TPR: 1.0000"],"type":"scatter","mode":"lines","line":{"width":5.29133858267716,"color":"rgba(230,159,0,1)","dash":"solid"},"hoveron":"points","name":"genotype (AUC = 0.81)","legendgroup":"genotype (AUC = 0.81)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0,0.0013,0.0013,0.0013,0.0038,0.0038,0.0064,0.0064,0.0089,0.0089,0.0102,0.0102,0.0114,0.0114,0.0152,0.0152,0.0165,0.0165,0.0178,0.0191,0.0191,0.0216,0.0216,0.0318,0.0318,0.0356,0.0356,0.0368,0.0368,0.0394,0.0394,0.0407,0.0407,0.0432,0.0483,0.0483,0.0496,0.0496,0.0508,0.0508,0.0584,0.0584,0.0635,0.0635,0.0762,0.0788,0.108,0.1105,0.1245,0.1271,0.1372,0.1423,0.1512,0.1537,0.1614,0.1639,0.1665,0.169,0.1779,0.1804,0.1855,0.1931,0.1957,0.2643,0.2668,0.2948,0.2948,0.3024,0.305,0.3215,0.324,0.3393,0.3443,0.3456,0.352,0.3647,0.3672,0.3812,0.3837,0.385,0.3926,0.3952,0.4015,0.4104,0.413,0.4384,0.4422,0.4435,0.4473,0.4562,0.4612,0.4625,0.4663,0.507,0.8666,0.8844,0.8869,0.9009,0.9034,0.9187,0.9212,0.925,0.9276,0.9517,0.9543,0.9593,0.9619,0.9733,0.9949,1],"y":[0.0455,0.1364,0.1364,0.1591,0.2045,0.2045,0.2273,0.2273,0.25,0.25,0.3409,0.3409,0.4091,0.4091,0.4318,0.4318,0.5,0.5,0.5227,0.5455,0.5455,0.5909,0.5909,0.6136,0.6136,0.6364,0.6364,0.6591,0.6591,0.6818,0.6818,0.7045,0.7045,0.7273,0.7273,0.7727,0.7955,0.7955,0.8409,0.8409,0.8864,0.8864,0.9091,0.9091,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9318,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,0.9545,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"text":["FPR: 0.0000<br />TPR: 0.0455","FPR: 0.0000<br />TPR: 0.1364","FPR: 0.0013<br />TPR: 0.1364","FPR: 0.0013<br />TPR: 0.1591","FPR: 0.0013<br />TPR: 0.2045","FPR: 0.0038<br />TPR: 0.2045","FPR: 0.0038<br />TPR: 0.2273","FPR: 0.0064<br />TPR: 0.2273","FPR: 0.0064<br />TPR: 0.2500","FPR: 0.0089<br />TPR: 0.2500","FPR: 0.0089<br />TPR: 0.3409","FPR: 0.0102<br />TPR: 0.3409","FPR: 0.0102<br />TPR: 0.4091","FPR: 0.0114<br />TPR: 0.4091","FPR: 0.0114<br />TPR: 0.4318","FPR: 0.0152<br />TPR: 0.4318","FPR: 0.0152<br />TPR: 0.5000","FPR: 0.0165<br />TPR: 0.5000","FPR: 0.0165<br />TPR: 0.5227","FPR: 0.0178<br />TPR: 0.5455","FPR: 0.0191<br />TPR: 0.5455","FPR: 0.0191<br />TPR: 0.5909","FPR: 0.0216<br />TPR: 0.5909","FPR: 0.0216<br />TPR: 0.6136","FPR: 0.0318<br />TPR: 0.6136","FPR: 0.0318<br />TPR: 0.6364","FPR: 0.0356<br />TPR: 0.6364","FPR: 0.0356<br />TPR: 0.6591","FPR: 0.0368<br />TPR: 0.6591","FPR: 0.0368<br />TPR: 0.6818","FPR: 0.0394<br />TPR: 0.6818","FPR: 0.0394<br />TPR: 0.7045","FPR: 0.0407<br />TPR: 0.7045","FPR: 0.0407<br />TPR: 0.7273","FPR: 0.0432<br />TPR: 0.7273","FPR: 0.0483<br />TPR: 0.7727","FPR: 0.0483<br />TPR: 0.7955","FPR: 0.0496<br />TPR: 0.7955","FPR: 0.0496<br />TPR: 0.8409","FPR: 0.0508<br />TPR: 0.8409","FPR: 0.0508<br />TPR: 0.8864","FPR: 0.0584<br />TPR: 0.8864","FPR: 0.0584<br />TPR: 0.9091","FPR: 0.0635<br />TPR: 0.9091","FPR: 0.0635<br />TPR: 0.9318","FPR: 0.0762<br />TPR: 0.9318","FPR: 0.0788<br />TPR: 0.9318","FPR: 0.1080<br />TPR: 0.9318","FPR: 0.1105<br />TPR: 0.9318","FPR: 0.1245<br />TPR: 0.9318","FPR: 0.1271<br />TPR: 0.9318","FPR: 0.1372<br />TPR: 0.9318","FPR: 0.1423<br />TPR: 0.9318","FPR: 0.1512<br />TPR: 0.9318","FPR: 0.1537<br />TPR: 0.9318","FPR: 0.1614<br />TPR: 0.9318","FPR: 0.1639<br />TPR: 0.9318","FPR: 0.1665<br />TPR: 0.9318","FPR: 0.1690<br />TPR: 0.9318","FPR: 0.1779<br />TPR: 0.9318","FPR: 0.1804<br />TPR: 0.9318","FPR: 0.1855<br />TPR: 0.9318","FPR: 0.1931<br />TPR: 0.9318","FPR: 0.1957<br />TPR: 0.9318","FPR: 0.2643<br />TPR: 0.9318","FPR: 0.2668<br />TPR: 0.9318","FPR: 0.2948<br />TPR: 0.9318","FPR: 0.2948<br />TPR: 0.9545","FPR: 0.3024<br />TPR: 0.9545","FPR: 0.3050<br />TPR: 0.9545","FPR: 0.3215<br />TPR: 0.9545","FPR: 0.3240<br />TPR: 0.9545","FPR: 0.3393<br />TPR: 0.9545","FPR: 0.3443<br />TPR: 0.9545","FPR: 0.3456<br />TPR: 0.9545","FPR: 0.3520<br />TPR: 0.9545","FPR: 0.3647<br />TPR: 0.9545","FPR: 0.3672<br />TPR: 0.9545","FPR: 0.3812<br />TPR: 0.9545","FPR: 0.3837<br />TPR: 0.9545","FPR: 0.3850<br />TPR: 0.9545","FPR: 0.3926<br />TPR: 0.9545","FPR: 0.3952<br />TPR: 0.9545","FPR: 0.4015<br />TPR: 0.9545","FPR: 0.4104<br />TPR: 0.9545","FPR: 0.4130<br />TPR: 0.9545","FPR: 0.4384<br />TPR: 0.9545","FPR: 0.4422<br />TPR: 0.9545","FPR: 0.4435<br />TPR: 0.9545","FPR: 0.4473<br />TPR: 0.9545","FPR: 0.4562<br />TPR: 0.9545","FPR: 0.4612<br />TPR: 0.9545","FPR: 0.4625<br />TPR: 0.9545","FPR: 0.4663<br />TPR: 0.9545","FPR: 0.5070<br />TPR: 0.9545","FPR: 0.8666<br />TPR: 1.0000","FPR: 0.8844<br />TPR: 1.0000","FPR: 0.8869<br />TPR: 1.0000","FPR: 0.9009<br />TPR: 1.0000","FPR: 0.9034<br />TPR: 1.0000","FPR: 0.9187<br />TPR: 1.0000","FPR: 0.9212<br />TPR: 1.0000","FPR: 0.9250<br />TPR: 1.0000","FPR: 0.9276<br />TPR: 1.0000","FPR: 0.9517<br />TPR: 1.0000","FPR: 0.9543<br />TPR: 1.0000","FPR: 0.9593<br />TPR: 1.0000","FPR: 0.9619<br />TPR: 1.0000","FPR: 0.9733<br />TPR: 1.0000","FPR: 0.9949<br />TPR: 1.0000","FPR: 1.0000<br />TPR: 1.0000"],"type":"scatter","mode":"lines","line":{"width":5.29133858267716,"color":"rgba(86,180,233,1)","dash":"solid"},"hoveron":"points","name":"genotype + clinic (AUC = 0.942)","legendgroup":"genotype + clinic (AUC = 0.942)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1.01],"y":[0,1.01],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":29.0178497301785,"r":9.29846409298464,"b":57.5149854711499,"l":69.7331672893317},"font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,1.01],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":15.9375674553757},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"False positive rate","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0,1.01],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":4.64923204649232,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":15.9375674553757},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"True positive rate","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":23.9103362391034},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"y":0.25,"x":0.45,"yanchor":"top","margin":{"l":110,"b":150,"t":40,"r":100,"pad":4}},"hovermode":"closest"},"source":"A","attrs":{"ffe474716569":{"x":{},"y":{},"colour":{},"type":"ggplotly"},"ffe440b90c38":{"intercept":{},"slope":{}}},"cur_data":"ffe474716569","visdat":{"ffe474716569":["function (y) ","x"],"ffe440b90c38":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p class="caption">
Figure 4: Receiver operator characteristic plots from validation set for logistic regression models built from genotype (orange) alone and the combination of genotype and clinic (blue). AUC improves when clinic is included in the model
</p>
</div>
<p>While this measure indicates improved performance between the two models, the AUC is not always the ideal metric when the data is imbalanced since it is insensitive to the false positive rate. A second, potentially more informative metric this case might be the precision-recall curve, which is more informative to how well the models are classifying the patients (figure 5). Here the average precision score (AP) increases from 0.20 to 0.64, again illustrating superior performance when clinic is included in the model.</p>
<div class="figure"><span id="fig:precision-recall"></span>
<img src="/post/ovation-diagnostics_files/figure-html/precision-recall-1.png" alt="Precision-recall curves calulated from the validation set using the models for genotype (orange) alone and the combination of genotype and clinic (blue). Average precision score increases when clinic is included in the model" width="672" />
<p class="caption">
Figure 5: Precision-recall curves calulated from the validation set using the models for genotype (orange) alone and the combination of genotype and clinic (blue). Average precision score increases when clinic is included in the model
</p>
</div>
<p>An additional benefit of using a logistic regression for this problem was that I could extract the important features (those with the highest absolute coefficient values) and evaluate whether they made sense with respect to being important predictors for a positive opioid diagnosis (figure 6). The top 4 most important features were all clinics, with the top two having the highest proportion of opioid patients in the dataset. As a form of validating these important clinics, I looked up the location for the top 3 clinics and found that they do in fact reside in areas with elevated opioid overdose rates. Interestingly, the following 4 important features were all genes that are part of the cytochrome P450 family of enzymes commonly found in drug metabolism pathways. Of note is the CYP2D6 gene, which commonly metabolizes opioids into morphine and variants have been identified as contributing to addiction-related pathways.</p>
<div class="figure"><span id="fig:feat-importances"></span>
<img src="/post/ovation-diagnostics_files/figure-html/feat-importances-1.png" alt="Important features from the model trained on the genotype and clinic data." width="672" />
<p class="caption">
Figure 6: Important features from the model trained on the genotype and clinic data.
</p>
</div>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>These modeling efforts reveal a potentially powerful tool that could aid in identifying patients at risk for developing opioid dependence. These results suggest that in addition to genotype data, the clinic plays an important role in identifying patients with opioid dependence. It is important to recognize that genotype alone cannot and should not be used diagnose opioid dependence on its own, but could rather be used as an indicator for increased likelihood of susceptibility to dependance. While the efforts discussed here are preliminary and limited to a small sample size, it points towards a potentially useful application in identifying such patients so that future treatment can attempt to minimize their risk of converting to a dependent state.</p>
<p>In performing my analysis, I was also interested in looking at the overlapping diagnoses that accompanied the positive opioid abuse diagnosis. I found that there were 12 diagnoses within this dataset that correlated with opioid abuse (figure 7). In the future, these features could be incorporated into the model to improve how we identify the at-risk patients.</p>
<div class="figure"><span id="fig:overlapping-diseases"></span>
<img src="/post/ovation-diagnostics_files/figure-html/overlapping-diseases-1.png" alt="Patient counts for diseases that occurred concurrently with the opioid dependence diagnosis" width="672" />
<p class="caption">
Figure 7: Patient counts for diseases that occurred concurrently with the opioid dependence diagnosis
</p>
</div>
<p>An ideal model, and one that was outside of the scope of what I could accomplish within this project, might be one that identifies populations or even geographic regions with elevated opioid dependence risk so that genetic screening could be used to quantify individual patient-risk for opioid abuse. The idea being that one could suggest that clinics found in these “hot-spot” regions perform these genetic tests so that pain medication prescriptions and dosages could be personalized to reduce the likelihood of converting a patient to a dependent state while still providing adequate pain management. Incorporating data on demographics, geographic location, and potential indicator diagnoses (e.g. long-term drug therapy) would be useful in implementing such a model.</p>
<p>Demo slides can be found <a href="https://docs.google.com/presentation/d/1eIifHITMQxFXhcWFmiNOls03I0ydZka_jO2FMpb7H6o/edit?usp=sharing">here</a></p>
</div>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/opioid-epidemic/">Opioid Epidemic</a>

  <a class="tag tag--primary tag--small" href="/tags/genetics/">Genetics</a>

  <a class="tag tag--primary tag--small" href="/tags/data-science/">Data Science</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Matthew Paff. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="/img/finn.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Matthew Paff</h4>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Aspiring Data Scientist
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Boston, MA
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2018/02/ovation-diagnostics/">
                <h3 class="media-heading">Ovation.io</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Identifying patients at risk for opioid dependence Matthew Paff, an Insight Health Data Science fellow (Spring, 2018), recently graduated from the University of Texas at Austin with a Ph.D. in Cell and Molecular Biology. There he modeled population dynamics of transmissible anti-viral defense using bacteriophage (viruses that infect bacteria) and developed novel approaches for genetically engineering attenuated vaccines.
This spring I participated in the Insight Health Data Science Fellowship, working as a consultant for Ovation; a provider of cloud-based LIMS and commercial platform for specialzed diagnostic labs.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         1 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/cover.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2018\/02\/ovation-diagnostics\/';
          
            this.page.identifier = '\/2018\/02\/ovation-diagnostics\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'hugo-tranquilpeak-theme';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

